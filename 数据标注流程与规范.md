# 数据标注流程与规范

## 任务介绍
标注者分别扮演**有知识聊天需求的用户**与**能使用搜索引擎的BOT**进行话题深入聊天。
**整体要求：1）整体对话流畅自然；2）构建的搜索query合适；3）知识使用时机合理；4）知识引入准确、自然、口语化。（2022.01.20更新）** 

## 标注要求
* 扮演用户：
    * **请直入主题，省略打招呼，再见等无意义的闲聊；对话结尾不要有结束语**
    * 兴趣和位置可作为聊天话题发起点，也可以进行话题发散，不做限制；
    * 一组对话的聊天轮数**至少5轮**。
* 扮演BOT：
    * 在每组对话中，BOT **至少2次**使用搜索引擎的知识进行回复；
    * **严禁完全复制知识**，需要对知识进行口语化加工；
    * 搜索引擎可多次构建query检索，直到找到满意的知识；
    * 支持多种知识类型，本地生活（『今天天气』，『附近的景点』，『去环球影城怎么走』等【默认地点为USER设定的位置】）、通用知识检索（参考平时使用的搜索引擎，常识类、经验类等等）。搜索query也可做一定发散，但要保证知识是上下文相关的；
    * 一组对话的聊天轮数**至少5轮**；
    * 目前知识检索工具较慢，点击检索后请耐心等待，不要多次重复点击。

### 流程细化（2022.01.20更新）
* 标注是 自己开两个窗口 同时扮演 USER 和 BOT，先后『开始对话』匹配到一起。如果是显示 对方提前关闭，说明是另一个角色退出或掉线了。
* 聊够5轮（10句）及以上，任意一方点击『结束对话』，USER方完成打分，才算完成一组完整对话。
* 第2点完成后，会返回一个 对话id，自己记录下来作为工作量统计标准。
* 根据同步的话题是否一致，判断是不是匹配到了自己，如果匹配到了其他人，可以结束对话重新匹配。
* 工具方法可参考「step1」标注流程与说明，使用中遇到问题，可以在群里随时反馈。
* 扮演BOT角色中的检索功能，返回结果需稍等几秒，属正常情况

### 规范细化（2022.01.20更新）
* 检索Query设计问题。知识检索时，最好使用更具体、明确的Query，我们的搜索工具可以支持问答形式的Query。
如：对话是『USER: 你们处女座和什么星座最合得来？』 建议搜索Query是 『处女座和什么星座最配』，不建议直接搜索『处女座』
* 是否使用知识的问题。BOT方提交对话时，如果回复没有搜索知识，或搜到的知识没有用，一定要在弹窗中选择『否』，只有使用了检索出的知识（加以口语化），才选择『是』。可以多次检索，找到自己想用的知识，每组对话至少有两次使用知识。
* 每组对话结束时，不要有结束语，要留下能继续对话的空间。
* 话题不需要从头到尾围绕给定话题，可以进行相关话题的跳转，跳转合理、连贯即可。
* USER方避免可以配合，避免持续进行简单提问。
* BOT和USER看到的兴趣和位置都是指USER的。
* 我们的检索系统，支持一些基于USER位置的服务能力，预设位置是为USER设置的地点。
可以直接使用类似如下的检索Query获取知识，如『附近的美食』、『附近的景点』、『附近的地铁站』、『到上海迪士尼怎么走』、『今天天气』等
设计对话时，有需要的情况下可以尝试加入一些这类知识。比如【USER】在家好无聊，想出去玩。（位置: 百度科技园）【Query】附近的景点【知识】找到了好几个景点,为你推荐颐和园,距离5.0公里【BOT】你可以去附近的颐和园逛逛呀，也不远，才5公里。

### 规范细化（2022.02.25更新）
* 增加技能类话题，包括中英翻译、计算器、时间查询、股价查询、万年历等。
* 可以只聊技能相关的话题，也可以穿插在其他话题or闲聊之中，也可以多个技能混着聊。
* 不必局限于case的聊天模式，可以随意聊天，对话流畅，在合适的实际搜索并使用知识即可。
* 示例： 

### Case1（2022.02.25更新）

**兴趣：** 技能 计算器

**位置：** 湖北省十堰市（坐标：110.799291，32.629462）

**对话：**

【USER】：看你这么聪明，出几个题考考你？

【BOT】：放马过来，算数、翻译什么的都不在话下！

【USER】：先来个简单的，四加五等于几？

【BOT】：当然是等于9，这太简单了吧

*搜索Query：4加5等于几 *  
*搜索知识：4加5等于9 *

【USER】：那我出个难的，1231乘25呢！

【BOT】：这难不倒我，1231乘以25等于30775

*搜索Query：1231乘以25 *  
*搜索知识：1231乘以25等于30775 *

【USER】：这么厉害呢，763412除以134 ！！

【BOT】：5697.1045，服了吗

*搜索Query：763412除以134 *  
*搜索知识：763412除以134等于5697.1045 *

【USER】：那我问你，你真是个聪明的机器人，英语怎么说

【BOT】：You're a smart robot. 嘻嘻...

*搜索Query：英语你真是个聪明的机器人 *  
*搜索知识：你真是个聪明的机器人的英文是:You're a smart robot *


### Case2（2022.02.25更新）

**兴趣：** 技能 万年历

**位置：** 湖北省十堰市（坐标：110.799291，32.629462）

**对话：**

【USER】：早上好呀！

【BOT】：现在都下午了，你还说早上好？

*搜索Query：现在几点了 *  
*搜索知识：现在是下午5点57分，下午好 *

【USER】：我逗你玩的，嘻嘻，下午好

【BOT】：今天是星期五啦，马上就到周末了，提前祝周末愉快呀！

*搜索Query：今天日期 *  
*搜索知识：今天是2022年2月25日，星期五，农历正月二十五 *

【USER】：哈哈，谢谢，一直盼着周末呢

【BOT】：你打算去哪玩呢？

【USER】：出去爬山散散心，昨天我的股票跌惨了，我买的茅台

【BOT】：今天涨了1.98%呢，已经每股1799.06了，快嗨起来。

*搜索Query：茅台股价 *  
*搜索知识：贵州茅台A股现在每股1799.06人民币,涨幅1.98%,总市值2.26万亿人民币,已收盘。 *

【USER】：哇，真的呀，赞

【BOT】：恭喜恭喜呀，感觉可以长期持有



## 标注流程
### 开始对话

![image](https://github.com/zh215021/SEAD/blob/main/images/user_start.png)
![image](https://github.com/zh215021/SEAD/blob/main/images/bot_start.png)

### 对话中

![image](https://github.com/zh215021/SEAD/blob/main/images/user_dial.png)
![image](https://github.com/zh215021/SEAD/blob/main/images/bot_dial.png)

### 结束对话

![image](https://github.com/zh215021/SEAD/blob/main/images/user_end.png)
![image](https://github.com/zh215021/SEAD/blob/main/images/bot_end.png)

### 记录对话id（工作量统计）
![image](https://github.com/zh215021/SEAD/blob/main/images/session_id.png)

**工具可单人分饰两角标注。**

方法：打开两个标注工具网页窗口，并保证两个窗口被分到的角色不同（一个USER、一个BOT，如果角色相同可尝试刷新界面，或再开一个窗口）。标注完成后，在任意一方点击『结束对话』，记录双方的对话id，并在USER方为对话打分自评（BOT方整体回复质量打分，客观评价，不影响工作量统计）。

注：无需记录对话内容，后台日志会有记录，仅需记录自己每组标注完成的对话id即可


## 对话Good Case示例
### Case1：
**兴趣：** 泛娱乐、演员、胡歌 

**地点：** 湖南省长沙市（坐标：112.938884，28.22808）

**对话：**

【USER】：今天外边天气看上去不太好

【BOT】：是的，长沙今天阴有小雨，要是出去玩记得带伞~ 

*搜索Query ：长沙天气*  
*搜索知识 ：长沙今天小雨，6度～9度，比北京今天高4度，当前空气质量指数109，轻度污染，请记得带伞。*

【USER】：不打算出去，在家宅着了。

【BOT】：那你打算在家干什么呀？

【USER】：我正看电视剧呢，琅琊榜，我都看第二遍了，超喜欢胡歌！

【BOT】：我也是，他演的《伪装者》、《仙剑奇侠传》也很好看！

*搜索Query：胡歌电视剧*  
*搜索知识：1.2005年主演仙侠剧《仙剑奇侠传》2.2009年主演仙侠剧《仙剑奇侠传三》3.2010年主演穿越剧《神话》4.2011年参演历史题材电影《辛亥革命》5.2012年主演玄幻剧《轩辕剑之天之痕》6.2014年主演战争剧《四十九日·祭》7.2015年主演谍战剧《伪装者》、古装剧《琅琊榜》8.2018年主演都市剧《猎场》*

【USER】：你知道他在琅邪榜里扮演谁嘛？

【BOT】：当然知道，江左梅郎，梅长苏，麒麟才子，得之可得天下！

*搜索Query：胡歌琅琊榜*  
*搜索知识：讲述了“麒麟才子”梅长苏才冠绝伦、以病弱之躯拨开重重迷雾、智博奸佞，为昭雪多年冤案、扶持新君所进行的一系列斗争。该剧于2015年9月19日登陆北京卫视、东方卫视首播。梅长苏（胡歌饰）本远在江湖，却名动帝辇。江湖传言：“江左梅郎，麒麟之才，得之可得天下。”作为天下第一大帮“江左盟”的首领，梅长苏“梅郎”之名响誉江湖。*

【USER】：厉害了，懂得挺多嘛。

【BOT】：那当然，我可是无所不知。

### Case2：

**兴趣：** 生活、旅游、爬山

**位置：** 山东省烟台市（坐标：121.447852，37.464539）

**对话：**

【USER】: 我爬山脚扭伤了

【BOT】: 啊，伤得严重嘛

【USER】: 爬泰山爬的，人太多了，稍微一不注意就被挤了一下

【BOT】: 喷点云南白药，可以活血止痛，下次可得注意点呀

*搜索Query：扭伤的药*  
*搜索知识：扭伤药有云南白药喷剂、红花油、活血止痛散等具有活血通络，化瘀止痛、消瘀散结功效，药物组成主要有红花、生地黄、桃仁、牛膝、杜仲、土鳖子、寄生等药物。扭伤应立即进行冷敷，冷敷可以使局部血管收缩，控制出血，等24小时左右，再配合活血通络的药物进行治疗。扭伤后要注意局部保暖，避免受凉，注意多休息，不可过多的活动。*

【USER】: 恩呢 已经处理好了 今年准备去华东转转，好些山的景色都不错，比如徽杭古道边上的清凉峰，你知道么

【BOT】: 知道呀，海拔1787米，是浙西的第一高峰，你准备啥时候去呀

*搜索Query：清凉峰*  
*搜索知识：清凉峰，国家级自然保护区，位于安徽省东南部绩溪县、歙县、浙江省西北部杭州市临安区两省三县区交界处。浙江清凉峰国家级自然保护区总面积11252公顷，主峰为清凉峰，海拔1787.4米，系浙西第一高峰，清凉峰保护区因此而得名。*

【USER】: 夏天吧 徒步难度还有点大 你去过没

【BOT】: 我没去过，不过看过不少攻略，据说从鱼龙川逍遥河水电站开始登山比较不错 

*搜索Query：清凉峰经典爬上路线*  
*搜索知识 ：我们这里主要讲述的是从绩溪县伏岭镇鱼龙川逍遥河水电站进入的方式。▌简要路书从安徽绩溪县坐小面包车到伏岭镇鱼龙川逍遥河水电站,开始正式徒步徽杭古道;鱼龙川—江南第一关—黄茅培—下雪堂—绿井—上雪堂—蓝天凹—野猪谠—三岔口,再翻越三条横向山脊看到清凉峰北坡,登顶。▌特点分析这条路线进山的优点自不必说,沿途看见的是徽杭古道的典型风光,山川河谷,美不胜收。*

【USER】: 嗯嗯 是的 我也查过，就是不知道一天能不能走完，不用在山上露营吧

【BOT】: 一天能走完，不过难度很大的，估计上山得5个小时，下山得5个小时，建议还是准备露营的方案吧

*搜索Query：清凉峰一天能爬完吗*  
*搜索知识：走到最后简直感觉每一步都提心吊胆,登山杖也撑得没力气了,五小时上山、五小时下山,回来四肢都相当酸爽~因为天气原因,在山上没看到任何风景,一片雾蒙蒙,再加上下雨,清凉峰还真的是清凉啊...清凉峰最高海拔1787.4米,虽然环线一天就走完,但难度还是蛮大的,不建议刚接触户外的同学走。*

【USER】: 好吧 那得再想想了 要是人多的话，能保证安全，早起看云海还挺好的

【BOT】: 嗯，到时候你可别再扭着脚了，建议备一瓶云南白药

### Case3：

**兴趣：** 生活、宠物、狗

**位置：** 湖北省十堰市（坐标：110.799291，32.629462）

**对话：**

【USER】：你想不想养狗？我家狗刚刚生了

【BOT】：额，什么狗？能长多大？

【USER】：阿拉斯加，能长的比你高吧

【BOT】：太大了，养不起，它可是雪橇犬啊，家里哪里有地方养他。

*搜索Query：阿拉斯加犬*  
*搜索知识：阿拉斯加犬(AlaskanMalamute),又称阿拉斯加马拉穆,是最古老的雪橇犬之一,原产于美国,AKC分类属工作犬组。因它的四肢发达,体格健壮,培育它的目的是为了耐力而不是速度,因而它们的主要用途是拉雪橇。作为宠物,阿拉斯加雪橇犬一旦成熟后有着非常安静、高雅的气质,而且它们忠于主人。*

【USER】：不用很大的地方呀，定时出去遛它就好啦。

【BOT】：算了吧，我很懒。话说现在很多地方都出台了禁养犬的名单，我记得湖北省的名单里就有雪橇犬哦

*搜索Query：湖北省十堰市禁养犬名单*  
*搜索知识：以下工作用犬所有种类的獒犬(Mastiff)雪橇犬(Malamute)拳狮犬(Boxer)笃宾犬(Dobermann)大丹犬(GreatDane)大白熊犬(GreatPyrenees)纽芬兰犬(NewFoundLand)可蒙多犬(Komondor)罗威纳犬(Rottweiler)圣伯纳犬(St.Bernard)萨摩耶德犬(Samoyed)德国牧羊犬(GermanShepherdDog)等;2.以下猎犬阿富汗猎犬(AfghanHound)巴山基猎犬(BassetHound)寻血猎犬(Bloodhound)苏俄牧羊犬(Borzoi)猎狐犬(Foxhound)*

【USER】：啊？我怎么不知道，倒是听说现在呼吁大家去办狗证了，我还没动呢

【BOT】：我也是听说的，你可以去相关单位看看，不过狗证还是赶紧办吧，这可是证明狗狗身份的证件，很重要哦

*搜索Query：狗证*  
*搜索知识：狗证是用于证明狗身份的一种法定证件。很多城市不准养烈性犬，狗肩过高也不准养，所以以前专门有群打狗队，你要是养条宠物狗那得办狗证，就是带去检查身体，一年办一次，和汽车年检差不多。在有些地方（飞机、火车）等带宠物必须出示狗证。*

【USER】：好吧好吧，我知道了，你真的不要吗？

【BOT】：额，算了吧，我连我都快养不活了
